---
immich:
  image:
    tag: v1.123.0

  immich:
    persistence:
      library:
        existingClaim: nfs-photos

  useDeprecatedPostgresChart: true

  postgresql:
    metrics:
      enabled: false
    enabled: true
    primary:
      resources:
        limits: {}
        requests:
          cpu: 250m
          memory: 256Mi

  redis:
    enabled: true
    commonConfiguration: |-
      # Enable AOF https://redis.io/topics/persistence#append-only-file
      appendonly no

  server:
    service:
      main: 
        annotations:
          metallb.universe.tf/loadBalancerIPs: 10.10.10.201
        type: LoadBalancer
    ingress:
      main:
        enabled: true
        annotations:
          kubernetes.io/ingress.class: "nginx"
          cert-manager.io/cluster-issuer: letsencrypt-issuer-prod
          # proxy-body-size is set to 0 to remove the body limit on file uploads
          nginx.ingress.kubernetes.io/proxy-body-size: "0"
        ingressClassName: nginx
        tls:
          - hosts:
            - immich.laferriere.app
            secretName: immich-secret
        hosts:
          - host: immich.laferriere.app
            paths:
              - path: /


